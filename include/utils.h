#pragma once

#include "direction.h"
#include <map>
#include <vector>

const std::vector<int> COLLEN = {5, 6, 7, 8, 9, 8, 7, 6, 5};
const std::vector<int> COLSUMS = {0, 5, 11, 18, 26, 35, 43, 50, 56};

const char PLAYER_1 = '1';
const char PLAYER_2 = '2';
const char EMPTY = '_';

std::map<int64_t, std::vector<direction>> possible_directions = {
    {1152921504606846976, {direction::NE}},
    {36028797018963968, {direction::N, direction::NE}},
    {562949953421312, {direction::N, direction::NE}},
    {4398046511104, {direction::N, direction::NE}},
    {17179869184, {direction::N}},
    {33554432, {direction::NW, direction::N}},
    {131072, {direction::NW, direction::N}},
    {1024, {direction::NW, direction::N}},
    {16, {direction::NW}},
    {8, {direction::SW, direction::NW}},
    {4, {direction::SW, direction::NW}},
    {2, {direction::SW, direction::NW}},
    {1, {direction::SW}},
    {32, {direction::S, direction::SW}},
    {2048, {direction::S, direction::SW}},
    {262144, {direction::S, direction::SW}},
    {67108864, {direction::S}},
    {34359738368, {direction::SE, direction::S}},
    {8796093022208, {direction::SE, direction::S}},
    {1125899906842624, {direction::SE, direction::S}},
    {72057594037927936, {direction::SE}},
    {144115188075855872, {direction::NE, direction::SE}},
    {288230376151711744, {direction::NE, direction::SE}},
    {576460752303423488, {direction::NE, direction::SE}},
};

std::map<direction, direction> reverse_direction = {
    {direction::N, direction::S},   {direction::NE, direction::SW},
    {direction::SE, direction::NW}, {direction::S, direction::N},
    {direction::SW, direction::NE}, {direction::NW, direction::SE},
};

std::map<direction, std::map<int64_t, int64_t>> next_element = {
    {direction::N,
     {{18014398509481984, 9007199254740992},
      {9007199254740992, 4503599627370496},
      {36028797018963968, 18014398509481984},
      {562949953421312, 281474976710656},
      {4398046511104, 2199023255552},
      {17179869184, 8589934592},
      {33554432, 16777216},
      {131072, 65536},
      {1024, 512},
      {4503599627370496, 2251799813685248},
      {281474976710656, 140737488355328},
      {140737488355328, 70368744177664},
      {70368744177664, 35184372088832},
      {35184372088832, 17592186044416},
      {2199023255552, 1099511627776},
      {1099511627776, 549755813888},
      {549755813888, 274877906944},
      {274877906944, 137438953472},
      {137438953472, 68719476736},
      {8589934592, 4294967296},
      {4294967296, 2147483648},
      {2147483648, 1073741824},
      {1073741824, 536870912},
      {536870912, 268435456},
      {268435456, 134217728},
      {16777216, 8388608},
      {8388608, 4194304},
      {4194304, 2097152},
      {2097152, 1048576},
      {1048576, 524288},
      {65536, 32768},
      {32768, 16384},
      {16384, 8192},
      {8192, 4096},
      {512, 256},
      {256, 128},
      {128, 64}}},
    {direction::NE,
     {{1152921504606846976, 18014398509481984},
      {18014398509481984, 140737488355328},
      {36028797018963968, 281474976710656},
      {562949953421312, 2199023255552},
      {4398046511104, 8589934592},
      {9007199254740992, 70368744177664},
      {144115188075855872, 2251799813685248},
      {288230376151711744, 4503599627370496},
      {576460752303423488, 9007199254740992},
      {4503599627370496, 35184372088832},
      {2251799813685248, 17592186044416},
      {281474976710656, 1099511627776},
      {140737488355328, 549755813888},
      {70368744177664, 274877906944},
      {35184372088832, 137438953472},
      {17592186044416, 68719476736},
      {2199023255552, 4294967296},
      {1099511627776, 2147483648},
      {549755813888, 1073741824},
      {274877906944, 536870912},
      {137438953472, 268435456},
      {68719476736, 134217728},
      {8589934592, 16777216},
      {4294967296, 8388608},
      {2147483648, 4194304},
      {1073741824, 2097152},
      {536870912, 1048576},
      {268435456, 524288},
      {16777216, 65536},
      {8388608, 32768},
      {4194304, 16384},
      {2097152, 8192},
      {1048576, 4096},
      {65536, 512},
      {32768, 256},
      {16384, 128},
      {8192, 64}}},
    {direction::SE,
     {{18014398509481984, 281474976710656},
      {9007199254740992, 140737488355328},
      {4503599627370496, 70368744177664},
      {2251799813685248, 35184372088832},
      {281474976710656, 2199023255552},
      {140737488355328, 1099511627776},
      {70368744177664, 549755813888},
      {35184372088832, 274877906944},
      {17592186044416, 137438953472},
      {2199023255552, 8589934592},
      {1099511627776, 4294967296},
      {549755813888, 2147483648},
      {274877906944, 1073741824},
      {137438953472, 536870912},
      {68719476736, 268435456},
      {4294967296, 16777216},
      {2147483648, 8388608},
      {1073741824, 4194304},
      {536870912, 2097152},
      {268435456, 1048576},
      {134217728, 524288},
      {8388608, 65536},
      {4194304, 32768},
      {2097152, 16384},
      {34359738368, 134217728},
      {8796093022208, 68719476736},
      {1125899906842624, 17592186044416},
      {72057594037927936, 2251799813685248},
      {144115188075855872, 4503599627370496},
      {288230376151711744, 9007199254740992},
      {576460752303423488, 18014398509481984},
      {1048576, 8192},
      {524288, 4096},
      {32768, 512},
      {16384, 256},
      {8192, 128},
      {4096, 64}}},
    {direction::S,
     {{9007199254740992, 18014398509481984},
      {4503599627370496, 9007199254740992},
      {2251799813685248, 4503599627370496},
      {140737488355328, 281474976710656},
      {70368744177664, 140737488355328},
      {35184372088832, 70368744177664},
      {17592186044416, 35184372088832},
      {1099511627776, 2199023255552},
      {32, 64},
      {2048, 4096},
      {262144, 524288},
      {67108864, 134217728},
      {34359738368, 68719476736},
      {8796093022208, 17592186044416},
      {1125899906842624, 2251799813685248},
      {549755813888, 1099511627776},
      {274877906944, 549755813888},
      {137438953472, 274877906944},
      {68719476736, 137438953472},
      {4294967296, 8589934592},
      {2147483648, 4294967296},
      {1073741824, 2147483648},
      {536870912, 1073741824},
      {268435456, 536870912},
      {134217728, 268435456},
      {8388608, 16777216},
      {4194304, 8388608},
      {2097152, 4194304},
      {1048576, 2097152},
      {524288, 1048576},
      {32768, 65536},
      {16384, 32768},
      {8192, 16384},
      {4096, 8192},
      {256, 512},
      {128, 256},
      {64, 128}}},
    {direction::SW,
     {{140737488355328, 18014398509481984},
      {70368744177664, 9007199254740992},
      {35184372088832, 4503599627370496},
      {17592186044416, 2251799813685248},
      {1099511627776, 281474976710656},
      {549755813888, 140737488355328},
      {274877906944, 70368744177664},
      {137438953472, 35184372088832},
      {68719476736, 17592186044416},
      {4294967296, 2199023255552},
      {2147483648, 1099511627776},
      {1073741824, 549755813888},
      {536870912, 274877906944},
      {268435456, 137438953472},
      {134217728, 68719476736},
      {16777216, 8589934592},
      {8388608, 4294967296},
      {4194304, 2147483648},
      {2097152, 1073741824},
      {1048576, 536870912},
      {524288, 268435456},
      {65536, 16777216},
      {32768, 8388608},
      {16384, 4194304},
      {8192, 2097152},
      {4096, 1048576},
      {512, 65536},
      {8, 512},
      {4, 256},
      {2, 128},
      {1, 64},
      {32, 4096},
      {2048, 524288},
      {262144, 134217728},
      {256, 32768},
      {128, 16384},
      {64, 8192}}},
    {direction::NW,
     {{281474976710656, 18014398509481984},
      {140737488355328, 9007199254740992},
      {70368744177664, 4503599627370496},
      {35184372088832, 2251799813685248},
      {2199023255552, 281474976710656},
      {1099511627776, 140737488355328},
      {549755813888, 70368744177664},
      {274877906944, 35184372088832},
      {137438953472, 17592186044416},
      {8589934592, 2199023255552},
      {4294967296, 1099511627776},
      {2147483648, 549755813888},
      {1073741824, 274877906944},
      {536870912, 137438953472},
      {268435456, 68719476736},
      {16777216, 4294967296},
      {8388608, 2147483648},
      {4194304, 1073741824},
      {2097152, 536870912},
      {1048576, 268435456},
      {524288, 134217728},
      {8, 256},
      {4, 128},
      {2, 64},
      {16, 512},
      {1024, 65536},
      {131072, 16777216},
      {33554432, 8589934592},
      {65536, 8388608},
      {32768, 4194304},
      {16384, 2097152},
      {8192, 1048576},
      {4096, 524288},
      {512, 32768},
      {256, 16384},
      {128, 8192},
      {64, 4096}}}};

std::map<int64_t, int64_t> four_in_a_row_cases = {
    {33776997205278720, 33776997205278720},
    {527765581332480, 545357767376896},
    {263882790666240, 545357767376896},
    {4123168604160, 4329327034368},
    {2061584302080, 4329327034368},
    {1030792151040, 4329327034368},
    {16106127360, 17045651456},
    {8053063680, 17045651456},
    {4026531840, 17045651456},
    {2013265920, 17045651456},
    {31457280, 33030144},
    {15728640, 33030144},
    {7864320, 33030144},
    {122880, 126976},
    {61440, 126976},
    {960, 960},
    {18155686827393024, 18155686829498432},
    {141288320008192, 18155686829498432},
    {550831661056, 18155686829498432},
    {1075847232, 18155686829498432},
    {282576640016384, 28257664003289},
    {1101663322112, 282576640032896},
    {2151694464, 282576640032896},
    {2203326644224, 2203326644480},
    {4303388928, 2203326644480},
    {8606777856, 8606777856},
    {2269460853424128, 2269460853424128},
    {35322080002048, 4538921707372544},
    {4538921706848256, 4538921707372544},
    {275415830528, 9077843414749184},
    {70644160004096, 9077843414749184},
    {9077843413696512, 9077843414749184},
    {2287260137422848, 2287260141650432},
    {35460327931904, 2287260141650432},
    {275955875840, 2287260141650432},
    {1077969408, 2287260141650432},
    {17730163965952, 17730163982592},
    {137977937920, 17730163982592},
    {538984704, 17730163982592},
    {68988968960, 68988969088},
    {269492352, 68988969088},
    {134746176, 134746176},
    {18298081099382784, 18298081099382784},
    {141841311727616, 9149040566468608},
    {9149040549691392, 9149040566468608},
    {551911751680, 4574520283299840},
    {70920655863808, 4574520283299840},
    {4574520274845696, 4574520283299840}};

static std::vector<std::string> board_string = {
    {" +-------------------------------------+ "},
    {" | A5  B6  C7  D8  E9  F8  G7  H6  I5  | "},
    {" |                                     | "},
    {" |                  x                  | "},
    {" |              x       x              | "},
    {" |          x       *       x          | "},
    {" |      x       *       *       x      | "},
    {" |  x       *       *       *       x  | "},
    {" |      *       *       *       *      | "},
    {" |  x       *       *       *       x  | "},
    {" |      *       *       *       *      | "},
    {" |  x       *       *       *       x  | "},
    {" |      *       *       *       *      | "},
    {" |  x       *       *       *       x  | "},
    {" |      *       *       *       *      | "},
    {" |  x       *       *       *       x  | "},
    {" |      x       *       *       x      | "},
    {" |          x       *       x          | "},
    {" |              x       x              | "},
    {" |                  x                  | "},
    {" |                                     | "},
    {" | A1  B1  C1  D1  E1  F1  G1  H1  I1  | "},
    {" +-------------------------------------+ "}};

static std::map<direction, std::string> m = {
    {direction::N, "N"}, {direction::NE, "NE"}, {direction::SE, "SE"},
    {direction::S, "S"}, {direction::SW, "SW"}, {direction::NW, "NW"}};

int64_t xytoint(int64_t x, int64_t y) { return 1 << (60 - (COLSUMS[x] + y)); }

int64_t no_of_set_bits(int64_t x) {
	int64_t count = 0;
	while (x) {
		count += x & 1;
		x >>= 1;
	}
	return count;
}
